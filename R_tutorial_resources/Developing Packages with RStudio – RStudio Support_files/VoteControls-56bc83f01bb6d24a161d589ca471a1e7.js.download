webpackJsonp([7],{"14717a9d4dd59f9f6464":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("abee22469401e1a5d45b"),l=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=l.default.extend({initialize:function(e){var t=e.type;this.type=t,this.listenTo(this.model,"change",this.render),this.cleanupAttributes()},render:function(){var e=void 0;switch(this.type){case"sum":e=this.model.get("vote_sum");break;case"count":e=this.model.get("vote_count")}this.$el.text(e)}})},"3f582cc3d5d8ae6d8eff":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("abee22469401e1a5d45b"),l=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=l.default.extend({initialize:function(){this.listenTo(this.model,"change",this.render),this.cleanupAttributes()},render:function(){this.$el.text(this.model.get("label"))}})},"6aee6681716a723e926b":function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=(0,u.default)("[data-helper=vote][data-item="+e+"]"),a=t.filter("[data-type=up], [data-type=down]"),o=t.filter("[data-type=label]"),l=t.filter("[data-type=count], [data-type=sum]");if(a.length){var i=d.default.get("user.role"),n=d.default.get("has_anonymous_kb_voting"),r="article"===e&&n&&"anonymous"===i,f=new s.Collection(null,{model:r?c.default:v.default}),h={buttons:[],labels:[],counters:[]};a.each(function(){var e=(0,u.default)(this).data(),t=e.id,a=e.value,o=e.label,l=e.type,i=e.selectedClass,n=e.upvoteCount,d=e.voteCount,s=e.voteSum,r=e.voteUrl,c=f.findWhere({id:t});c=c||f.add({id:t,value:a,label:o,upvote_count:n,vote_count:d,vote_sum:s,vote_url:r});var v=new b.default({model:c,el:this,direction:l,selectedClass:i});h.buttons.push(v),v.render()}),o.each(function(){var e=(0,u.default)(this).data(),t=e.id,a=f.findWhere({id:t}),o=new _.default({model:a,el:this});h.labels.push(o)}),l.each(function(){var e=(0,u.default)(this).data(),t=e.id,a=e.type,o=f.findWhere({id:t}),l=new y.default({model:o,el:this,type:a});h.counters.push(l)}),this.votes=f,this.views=h}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=a("81b23fecfbd347cceae1"),u=o(i),n=a("a8f8105d2d40178f277f"),d=o(n),s=a("1858b45bf48591489d06"),r=a("7d537e90ff311a731e3f"),c=o(r),f=a("d267070eb37c2442a2ed"),v=o(f),h=a("7624a2eeac1de43ab98b"),b=o(h),p=a("3f582cc3d5d8ae6d8eff"),_=o(p),g=a("14717a9d4dd59f9f6464"),y=o(g)},"7624a2eeac1de43ab98b":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("abee22469401e1a5d45b"),l=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=l.default.extend({events:{click:"onClick"},initialize:function(e){var t=e.direction,a=e.selectedClass;this.direction=t,this.selectedClass=a,this.listenTo(this.model,"change",this.render),this.cleanupAttributes()},render:function(){var e=this.direction===this.model.get("value");this.$el.toggleClass(this.selectedClass,e).attr("aria-selected",e)},onClick:function(e){e.preventDefault(),this.model.vote(this.direction)}})},"7d537e90ff311a731e3f":function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a("8e994c8287bafcdbd431"),i=o(l),u=a("1858b45bf48591489d06"),n=a("f53a66fb701477ccb562"),d=o(n);t.default=u.Model.extend({defaults:{upvote_count:0,vote_count:0,vote_sum:0,value:null,label:"",vote_url:""},constructor:function(){u.Model.apply(this,arguments),this.localStorageSupported=this.isLocalStorageSupported(),this.set({value:this.getVoteDirection()})},vote:function(e){var t=this,a=this.get("vote_url");if(this.alreadyVoted())return void this.fakeVote(e);u.$.ajax({url:a,type:"POST",data:{value:e},dataType:"json"}).done(function(e){t.saveVoteLocally(e.value),t.set(e)}).fail(function(){t.saveVoteLocally(e),t.set({value:e})})},alreadyVoted:function(){return null!==this.get("value")},getVoteDirection:function(){return this.readLocalVotes()[this.get("vote_url")]||null},fakeVote:function(e){var t=this.get("value")===e?"none":e;this.saveVoteLocally(t),this.set({value:t})},saveVoteLocally:function(e){var t=this.get("vote_url"),a=this.readLocalVotes();a[t]=e;var o=(0,i.default)(a);this.localStorageSupported?window.localStorage.setItem("articleVotes",o):d.default.set("articleVotes",o)},readLocalVotes:function(){var e=this.localStorageSupported?window.localStorage.getItem("articleVotes"):d.default.get("articleVotes");return JSON.parse(e||"{}")},isLocalStorageSupported:function(){try{return window.localStorage.setItem("testKey","1"),window.localStorage.removeItem("testKey"),!0}catch(e){return!1}}})},abee22469401e1a5d45b:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("1858b45bf48591489d06");t.default=o.View.extend({cleanupAttributes:function(){for(var e=this,t=this.el.attributes,a=[],o=0;o<t.length;o++){var l=t[o].nodeName;-1!==l.indexOf("data-")&&a.push(l)}a.forEach(function(t){return e.el.removeAttribute(t)})}})},d267070eb37c2442a2ed:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("1858b45bf48591489d06");t.default=o.Model.extend({defaults:{upvote_count:0,vote_count:0,vote_sum:0,value:null,label:"",vote_url:""},vote:function(e){var t=this,a=this.get("value"),l=this.get("vote_url"),i=void 0;i=a?a===e?"DELETE":"PUT":"POST",o.$.ajax({type:i,url:l,data:{value:e},dataType:"json"}).done(function(e){return t.set(e)})}})}});